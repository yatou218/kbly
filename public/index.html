<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>康保县乐途旅游发展有限公司_康保县乐途旅游发展有限公司</title>
    <link rel="stylesheet" href="css/all.css">
    <link rel="stylesheet" href="css/index.css">
</head>

<body onload="index_image()">
    <!--------头部-------------->
    <div class="banner">
        <!--logo-->
        <div class="banner_top">
            <div class="swiper">
                <!--图片区域-->
                <ul class="imgBox">
                    <li><img src="../public/img/header/i-1.png" /></li>
                    <li><img src="../public/img/header/i-2.jpg" /></li>
                </ul>
                <!--左右按钮-->
                <div class="btn pre">
                    <img src="../public/img/header/left_ar.png">
                </div>
                <div class="btn next">
                    <img src="../public/img/header/right_ar.png">
                </div>
                <!--小圆点-->
                <ul class="item">
                    <!--<li class="active"></li>
                <li></li>
                <li></li>-->
                </ul>
            </div>
            <div class="logo">
                <a href="kbly_index.html">
                    <img src="img/header/logo.png" alt="康保县乐途旅游发展有限公司">
                </a>
                <div class="logo_right">
                    <span>服务咨询热线：</span>
                    <p>0313-5550058</p>
                </div>
            </div>
            <!--导航栏-->
            <div class="nav_box">
                <a href="kbly_index.html" class="nav_home"></a>
                <ul>
                    <li><a href="about.html">关于我们</a></li>
                    <li><a href="culture.html">文化娱乐</a>
                        <ul class=normal>
                            <li><a href="javascript:;">二人台</a>
                            </li>
                            <li><a href="javascript:;">风筝节</a>
                            </li>
                            <li><a href="javascript:;">骑马</a></li>
                            <li><a href="javascript:;">射箭</a></li>
                            <li><a href="javascript:;">篝火晚会</a></li>
                        </ul>
                    </li>
                    <li><a href="accommodation.html">餐饮住宿</a>
                        <ul class="normal">
                            <li><a href="javascript:;">特色餐饮</a></li>
                            <li><a href="javascript:;">住宿环境</a></li>
                        </ul>
                    </li>
                    <li><a href="attractons.html">周边景点</a>
                        <ul class="normal">
                            <li><a href="javascript:;">金长城</a></li>
                            <li><a href="javascript:;">康保南天门</a></li>
                            <li><a href="javascript:;">康巴诺尔湖</a></li>
                        </ul>
                    </li>
                    <li><a href="road_trip.html">自驾游</a>
                        <ul class="normal">
                            <li><a href="javascript:;">地图导航</a></li>
                            <li><a href="javascript:;">野外露营</a></li>
                        </ul>
                    </li>
                    <li><a href="travel.html">旅游产品</a>
                        <ul class="normal">
                            <li><a href="javascript:;">康保肉石</a></li>
                            <li><a href="javascript:;">马奶酒</a></li>
                            <li><a href="javascript:;">肉石宴</a></li>
                        </ul>
                    </li>
                    <li><a href="visitor_center.html">游客中心</a></li>
                    <li><a href="hotels_view.html">酒店预订</a></li>
                    <li><a href="contact.html">联系我们</a></li>
                </ul>
                <img src="img/header/nav.png">
            </div>
        </div>
    </div>
    <!--搜索栏及天气-->
    <div class="neck">
        <div class="neck_box">
            <div class="neck_left">
            </div>
            <div class="neck_right">
                <div class="n_r_top">
                    <h2>站内公告：<h2><br>
                            <span>康保县乐途旅游发展有限公司恭候您的光临</span>
                </div>
            </div>
        </div>
    </div>
    <!--中部内容--->
    <!---1楼-->
    <div class="floor">
        <!---标题-->
        <div class="floor_title">
            <span>文化娱乐</span>
            <img class="right_img" src="img/indeximg/word1.jpg">
        </div>
        <!----图片-->
        <div class="floor_img">
            <!----左-->
            <div id="left" class="left"></div>
            <!---中-->
            <div id="center" class="center"></div>
            <!---右-->
            <div class="right">
                <p>更多文化娱乐:</p>
                <div class="p_div">
                    <a href="">二人台</a>
                    <a href="">风筝节</a>
                    <a href="">骑马</a>
                    <a href="">射箭</a>
                    <a href="">篝火晚会</a>
                </div>
            </div>
        </div>
        <!-- 1楼~2楼中间的图片 -->
        <img class="img_1F" src="img/indeximg/1F.jpg">
    </div>
    <!-- 2楼 -->
    <div class="floor">
        <!-- 标题 -->
        <div class="floor2_title">
            <span>餐饮住宿</span>
            <img class="right_img" src="img/indeximg/word2.jpg">
        </div>
        <!-- 图片 -->
        <div class="floor_img">
            <!-- 左 -->
            <div id="two_left" class="left"></div>
            <!---中-->
            <div id="two_center" class="center"></div>
            <!---右-->
            <div class="right">
                <p>更多餐饮住宿:</p>
                <div class="p_div">
                    <a href="">特色餐饮</a>
                    <a href="">住宿环境</a>
                </div>
            </div>

        </div>
        <!-- 2楼~3楼中间的图片 -->
        <img class="img_1F" src="img/indeximg/2F.jpg">
    </div>
    <!-- 3楼 -->
    <div class="floor">
        <!-- 标题 -->
        <div class="floor3_title">
            <span>周边景点</span>
            <img class="right_img" src="img/indeximg/33.jpg">
        </div>
        <!-- 图片 -->
        <div class="floor_img">
            <!-- 左 -->
            <div id="three_left" class="left"></div>
            <!---中-->
            <div id="three_center" class="center"></div>
            <!---右-->
            <div class="right">
                <p>更多周边景点:</p>
                <div class="p_div">
                    <a href="">金长城</a>
                    <a href="">康保南天门</a>
                    <a href="">康保诺尔湖</a>
                </div>
            </div>
        </div>
        <!-- 2楼~3楼中间的图片 -->
        <img class="img_1F" src="img/indeximg/3F.jpg">
    </div>
    <!-- 4楼 -->
    <div id="floor_4" class="floor">
        <!-- 标题 -->
        <div class="floor4_title">
            <span>旅游产品</span>
            <a href="#">>>更多</a>
        </div>
        <!-- 图片 -->
        <div class="floor_img">
            <!-- 左 -->
            <div id="four" class="four_left">
            </div>
            <!---右-->
            <div class="right">
                <div class="right_one">
                    <span>优惠</span>
                    <h3>[马奶酒]</h3>
                    <a href="#">马奶酒</a>
                </div>
                <div class="right_one">
                    <span>优惠</span>
                    <h3>[马奶酒]</h3>
                    <a href="#">马奶酒</a>
                </div>
                <div class="right_one">
                    <span>优惠</span>
                    <h3>[马奶酒]</h3>
                    <a href="#">马奶酒</a>
                </div>
                <div class="right_one">
                    <span>优惠</span>
                    <h3>[康保肉石]</h3>
                    <a href="#">肉石</a>
                </div>
            </div>
        </div>
        <div class="img_foot">
            <a href="#">
                <img src="img/indeximg/look_view.jpg">
            </a>
            <a href="#">
                <img src="img/indeximg/look_view.jpg">
            </a>
            <a href="#">
                <img src="img/indeximg/look_view.jpg">
            </a>
        </div>
    </div>
    <!--页脚-->
    <div>
        <iframe class="footer_size" src="footer.html" frameborder="0" scrolling="no"></iframe>
    </div>
</body>
<script>
    function index_image() {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                var result = xhr.responseText;
                //console.log(result);
                var json = JSON.parse(result);
                var info = ``;
                var flag = 0;
                for (var i = 0; i < json.length; i++) {
                    flag++;
                    info = `
                        <div>
                            <a href="#">
                                <img src="${json[i].img}">
                            </a>
                            <p>
                                <a href="#">${json[i].iname}</a>
                            </p>
                        </div>
                    `;
                    if (flag == 1) {
                        left.innerHTML = info;
                    } else if (flag <= 7) {
                        center.innerHTML += info;
                    } else if (flag == 8) {
                        two_left.innerHTML = info;
                    } else if (flag <= 14) {
                        two_center.innerHTML += info;
                    } else if (flag == 15) {
                        three_left.innerHTML = info;
                    } else if (flag <= 21) {
                        three_center.innerHTML += info;
                    } else {
                        four.innerHTML += info;
                    }
                }
            }
        }
        xhr.open("get", "/kbly/index", true);
        xhr.send();
    }
    window.onload = function () {
        let swiper = document.querySelector(".swiper"),
            pre = swiper.querySelector(".pre"),
            next = swiper.querySelector(".next"),
            _ul = swiper.querySelector(".imgBox"),//图片ul
            ali = _ul.querySelectorAll('li'),
            aImg = swiper.querySelectorAll("li img"),
            imgW = aImg[0].offsetWidth,//需要window.onload
            index = 1,//计算滚动到哪张图片
            isTransitioned = true,//判断动画是否已完成
            item = swiper.querySelector('.item');
        //克隆第一张图片，添加到图片队列的最后面
        let cloneLi = ali[0].cloneNode(true);
        _ul.appendChild(cloneLi);
        //克隆最后一张图片，添加到图片队列的最前面
        let cloneLastLi = ali[ali.length - 1].cloneNode(true);
        _ul.prepend(cloneLastLi);
        //点击右边按钮
        next.addEventListener("click", () => {
            if (isTransitioned) {
                index++;//先++再设置
                move();
                fenyeq(index);
            }
        })
        //初始化图片队列：
        _ul.style.transform = "translateX(" + (-imgW * index) + "px)";
        //点击左边按钮
        pre.addEventListener("click", () => {
            if (isTransitioned) {
                index--;
                move();
                fenyeq(index);
            }
        })
        setInterval(function () {
            if (isTransitioned) {
                index++;
                move();
                fenyeq(index);
            }
        }, 7000)
        //监听动画结束
        _ul.addEventListener("transitionend", () => {//给ul加了transi
            if (index == aImg.length + 1) {//边界判断
                index = 1;
                _ul.classList.toggle("transi");//移除ul的transi
                _ul.style.transform = "translateX(" + (-imgW * index) + "px)";//瞬间变回第一张
            }
            if (index == 0) {
                index = aImg.length;
                _ul.classList.toggle("transi");//移除ul的transi
                _ul.style.transform = "translateX(" + (-imgW * index) + "px)";//瞬间变回第一张
            }
            isTransitioned = true;//每次动画结束都判断
        })
        //根据图片的张数生成分页器
        for (let i = 0; i < aImg.length; i++) {
            var newLi = document.createElement('li');
            item.appendChild(newLi);
        }
        //第一个小圆点添加样式
        item.children[0].classList.add('active');
        //给分页器添加点击事件
        for (let j = 0; j < item.children.length; j++) {
            item.children[j].addEventListener('click', () => {
                for (let q = 0; q < item.children.length; q++) {
                    item.children[q].classList.remove('active');
                }
                item.children[j].classList.add('active');
                index = j + 1;
                _ul.classList.add('transi');
                _ul.style.transform = "translateX(" + (-imgW * index) + "px)";
            })
        }
        //点击左右按钮分页器跟随
        function fenyeq(index) {
            for (let k = 0; k < item.children.length; k++) {
                item.children[k].classList.remove('active');
            }
            index = index - 1;
            index = index == item.children.length ? 0 : index;//左按钮边界
            index = index < 0 ? item.children.length - 1 : index;//右按钮边界
            item.children[index].classList.add('active');
        }
        function move() {
            _ul.classList.add("transi");
            _ul.style.transform = "translateX(" + (-imgW * index) + "px)";
            isTransitioned = false;
        }
    }
</script>

</html>